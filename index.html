<! DOCTYPE>
<html lang="en">
	<head>
		<style> 
			html,body, #map_canvas{
				margin:0;
				padding:0;
				height: 100%;
			}
		</style>
		<link href="static/css/bootstrap.css" rel="stylesheet" type="text/css">
		<script type="text/javascript" src="static/js/jquery-1.7.2.min.js"> </script>
		<script type="text/javascript" src="static/js/bootstrap.min.js"> </script>
		<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=true"></script>
		<!--
		<script type="text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/maplabel/src/maplabel-compiled.js"> </script> --!>
		<script type="text/javascript"> 
			var map;
			var markers = new Array()

			function initMap(){
				$(document).ready(function(){
					console.log("initing map");
					var mapOptions = {
						zoom:2, 
						center: new google.maps.LatLng(0,0),
						 mapTypeId: google.maps.MapTypeId.ROADMAP
					};
					map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
						$.ajax({
							url:'static/all_sites.json',
							cache:false,
							dataType:'json',
							//crossDomain:true,
							success:function(data){
								for(var key in data){
									var site = data[key];
									var pos= new google.maps.LatLng( site.lat, site.lng)
								if(site.wind != ''){
									markers.push(new google.maps.Marker({
										text : site.wind,
										position : pos,
										map : map,
										icon: "static/arrows/arrow" +site.wind +".png"
									}));
								}else{
										new google.maps.Marker({
											position: pos, 
											map: map, 
											title: site.loc,
										});
									}
								}
							},
							error:function(resp, error, test){
							alert("failing");
						//		alert(error);
							}
						});
					google.maps.event.addListener(map, 'bounds_changed', function(){
					});
				});
			}
			google.maps.event.addDomListener(window, 'load', initMap);
		</script> 
	</head> 
	<body> 
		<div id="map_canvas"> </div>
	<body>
</html>
